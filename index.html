<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Il Nostro Matrimonio</title>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-SPEXQ7RSYX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SPEXQ7RSYX');
</script>
	
	
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Great+Vibes&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
	  
	  
	  /* Subito dopo "overflow-x: hidden;" del body, aggiungi: */

body.envelope-open {
  overflow: auto;
}

/* Envelope Animation - Aggiungi questa sezione completa */
.envelope-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, #f5f1e8 0%, #ebe4d6 100%);
  z-index: 10010;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: opacity 0.8s ease, visibility 0.8s ease;
}

.envelope-container.hide {
  opacity: 0;
  visibility: hidden;
}

.envelope-wrapper {
  position: relative;
  width: 320px;
  height: 220px;
  cursor: pointer;
  animation: envelopeBounce 2s ease-in-out infinite;
}

@keyframes envelopeBounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

.envelope-wrapper:hover .envelope-flap {
  transform: rotateX(-20deg);
}

.envelope-base {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 160px;
  background: linear-gradient(135deg, #faf8f0 0%, #ffffff 100%);
  border: 3px solid #c9a961;
  border-radius: 5px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

.envelope-flap {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 120px;
  background: linear-gradient(135deg, #ffffff 0%, #faf8f0 100%);
  border: 3px solid #c9a961;
  border-bottom: none;
  transform-origin: top center;
  transition: transform 0.3s ease;
  clip-path: polygon(0 0, 50% 60%, 100% 0);
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}

.envelope-flap::before {
  content: 'üíç';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 40px;
  animation: ringRotate 3s ease-in-out infinite;
}

@keyframes ringRotate {
  0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
  50% { transform: translate(-50%, -50%) rotate(20deg); }
}

.envelope-letter {
  position: absolute;
  top: 40px;
  left: 50%;
  transform: translateX(-50%);
  width: 85%;
  height: 140px;
  background: white;
  border: 2px solid #e8dfc8;
  border-radius: 3px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
  transition: transform 0.6s ease;
}

.envelope-wrapper:hover .envelope-letter {
  transform: translateX(-50%) translateY(-30px);
}

.envelope-letter-title {
  font-family: 'Great Vibes', cursive;
  font-size: 1.8em;
  color: #c9a961;
  margin-bottom: 8px;
}

.envelope-letter-text {
  font-size: 0.9em;
  color: #6b5d4f;
  line-height: 1.5;
  margin-bottom: 12px;
}

.envelope-click-hint {
  position: absolute;
  bottom: -60px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 1.1em;
  color: #a08763;
  animation: hintPulse 2s ease-in-out infinite;
  white-space: nowrap;
}

@keyframes hintPulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.main-content {
  opacity: 0;
  transition: opacity 1s ease;
}

.main-content.show {
  opacity: 1;
}
	  
	  
	  

      body {
        font-family: 'Cormorant Garamond', serif;
        background: linear-gradient(135deg, #f5f1e8 0%, #ebe4d6 100%);
        color: #6b5d4f;
        overflow-x: hidden;
      }

      .sparkle {
        position: fixed;
        width: 4px;
        height: 4px;
        background: #c9a961;
        border-radius: 50%;
        pointer-events: none;
        animation: sparkleFloat 4s infinite ease-in-out;
        opacity: 0;
      }

      @keyframes sparkleFloat {

        0%,
        100% {
          opacity: 0;
          transform: translateY(0) scale(0);
        }

        50% {
          opacity: 1;
          transform: translateY(-100px) scale(1);
        }
      }

      .hero {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 40px 20px 80px 20px;
        position: relative;
        background: linear-gradient(135deg, rgba(250, 248, 240, 0.9) 0%, rgba(245, 238, 225, 0.9) 100%);
      }

      .rings {
        font-size: 60px;
        animation: float 3s ease-in-out infinite;
        margin-bottom: 20px;
        filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.1));
      }

      @keyframes float {

        0%,
        100% {
          transform: translateY(0px);
        }

        50% {
          transform: translateY(-15px);
        }
      }

      h1 {
        font-family: 'Cormorant Garamond', serif;
        font-size: 2.8em;
        color: #a08763;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
        animation: fadeInDown 1s ease-out;
        font-weight: 300;
        letter-spacing: 3px;
        text-transform: uppercase;
      }

      .names {
        font-family: 'Great Vibes', cursive;
        font-size: 4em;
        color: #c9a961;
        margin: 20px 0;
        animation: fadeInUp 1s ease-out 0.3s both;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .ampersand {
        font-size: 0.7em;
        display: block;
        margin: 10px 0;
      }

      @keyframes fadeInDown {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .date {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.6em;
        color: #a08763;
        margin-bottom: 30px;
        animation: fadeInUp 1s ease-out 0.5s both;
        font-weight: 400;
        letter-spacing: 2px;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .countdown {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 30px 0;
        flex-wrap: wrap;
      }

      .countdown-box {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 15px;
        min-width: 90px;
        border: 2px solid #c9a961;
        animation: fadeInUp 1s ease-out 0.7s both;
      }

      .countdown-number {
        font-size: 2.5em;
        font-weight: 600;
        color: #c9a961;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      }

      .countdown-label {
        font-size: 0.9em;
        color: #a08763;
        margin-top: 5px;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-family: 'Montserrat', sans-serif;
        font-weight: 300;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .language-switcher {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9997;
        display: flex;
        gap: 10px;
        background: rgba(255, 255, 255, 0.9);
        padding: 10px 15px;
        border-radius: 25px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid #c9a961;
      }

      .lang-btn {
        background: transparent;
        border: 2px solid #c9a961;
        color: #a08763;
        padding: 8px 15px;
        border-radius: 20px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.9em;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
      }

      .lang-btn:hover {
        background: #faf8f0;
        transform: scale(1.05);
      }

      .lang-btn.active {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border-color: transparent;
      }

      .lang-en {
        display: none !important;
      }

      .lang-it {
        display: block;
      }

      body.lang-english .lang-it {
        display: none !important;
      }

      body.lang-english .lang-en {
        display: block !important;
      }

      section {
        background: #faf8f0;
        border-radius: 30px;
        margin-top: -60px;
        position: relative;
        z-index: 1;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        padding: 60px 20px;
        border: 8px solid transparent;
        border-image: repeating-linear-gradient(135deg,
            #c9a961 0px,
            #c9a961 10px,
            #b8945a 10px,
            #b8945a 20px,
            #d4af6a 20px,
            #d4af6a 30px) 8;
      }

      .section-content {
        max-width: 900px;
        margin: 0 auto;
      }

      .info-box {
        background: linear-gradient(135deg, #ffffff 0%, #faf8f0 100%);
        padding: 30px;
        border-radius: 15px;
        margin: 30px 0;
        transform: translateY(50px);
        opacity: 0;
        transition: all 0.8s ease-out;
        border: 4px solid #c9a961;
        box-shadow:
          0 5px 20px rgba(0, 0, 0, 0.05),
          inset 0 0 0 1px #e8dfc8,
          inset 0 0 0 5px #faf8f0;
        position: relative;
      }

      .info-box::before {
        content: '';
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        bottom: 10px;
        border: 1px solid #e8dfc8;
        border-radius: 10px;
        pointer-events: none;
      }

      .info-box.visible {
        transform: translateY(0);
        opacity: 1;
      }

      .info-box h2 {
        color: #a08763;
        font-size: 2em;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
        font-weight: 400;
        letter-spacing: 2px;
        line-height: 1.3;
      }

      .icon {
        font-size: 1.2em;
        animation: bounce 2s ease-in-out infinite;
        flex-shrink: 0;
      }

      @keyframes bounce {

        0%,
        100% {
          transform: translateY(0);
        }

        50% {
          transform: translateY(-10px);
        }
      }

      .info-box p {
        font-size: 1.15em;
        line-height: 1.9;
        color: #6b5d4f;
        font-weight: 400;
      }

      .maps-button {
        display: inline-block;
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        padding: 12px 25px;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 500;
        font-size: 1em;
        margin-top: 15px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(201, 169, 97, 0.3);
        font-family: 'Montserrat', sans-serif;
      }

      .maps-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 25px rgba(201, 169, 97, 0.5);
      }

      .hotel-list {
        display: block;
        margin-top: 10px;
        line-height: 2.2;
      }

      .hotel-item {
        display: block;
        margin-bottom: 8px;
      }

      .phone-link {
        color: #c9a961;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        border-bottom: 2px solid transparent;
      }

      .phone-link:hover {
        color: #a08763;
        border-bottom: 2px solid #a08763;
      }

      .gift-reveal-container {
        text-align: center;
      }

      .gift-reveal-button {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: none;
        padding: 15px 35px;
        border-radius: 25px;
        font-size: 1.15em;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.3);
        margin-bottom: 20px;
      }

      .gift-reveal-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(201, 169, 97, 0.5);
      }

      .gift-info-hidden {
        max-height: 0;
        overflow: hidden;
        transition: all 0.5s ease;
        opacity: 0;
      }

      .gift-info-hidden.show {
        max-height: 1000px;
        opacity: 1;
      }

      .gift-info-content {
        background: linear-gradient(135deg, #ffffff 0%, #faf8f0 100%);
        padding: 30px;
        border-radius: 15px;
        margin-top: 20px;
        border: 2px solid #e8dfc8;
        text-align: left;
      }

      .iban-box {
        background: white;
        padding: 20px;
        border-radius: 12px;
        border: 2px dashed #c9a961;
        margin: 15px 0;
        font-size: 1.05em;
        line-height: 1.8;
      }

      .iban-code {
        font-family: 'Courier New', monospace;
        background: #faf8f0;
        padding: 5px 10px;
        border-radius: 5px;
        font-weight: bold;
        color: #a08763;
        letter-spacing: 1px;
      }

      .copy-iban-btn {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 20px;
        font-size: 1em;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
        margin-top: 10px;
        width: 100%;
      }

      .copy-iban-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.4);
      }

      .menu-selection {
        background: #faf8f0;
        padding: 20px;
        border-radius: 15px;
        margin: 10px 0;
        border: 2px solid #e8dfc8;
      }

      .menu-selection h3 {
        color: #a08763;
        font-size: 1.2em;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 500;
      }

      .menu-selection select {
        margin-top: 8px;
      }

      .rsvp-form {
        background: linear-gradient(135deg, #ffffff 0%, #faf8f0 100%);
        padding: 40px 30px;
        border-radius: 15px;
        margin-top: 40px;
        border: 4px solid #c9a961;
        box-shadow:
          0 5px 20px rgba(0, 0, 0, 0.05),
          inset 0 0 0 1px #e8dfc8,
          inset 0 0 0 5px #faf8f0;
        position: relative;
      }

      .rsvp-form::before {
        content: '';
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        bottom: 10px;
        border: 1px solid #e8dfc8;
        border-radius: 10px;
        pointer-events: none;
      }

      .rsvp-form h2 {
        color: #a08763;
        font-size: 2.2em;
        margin-bottom: 30px;
        text-align: center;
        font-weight: 400;
        letter-spacing: 2px;
      }

      .form-group {
        margin-bottom: 25px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: #a08763;
        font-weight: 600;
        font-size: 1.05em;
        font-family: 'Montserrat', sans-serif;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 15px;
        border: 2px solid #e8dfc8;
        border-radius: 12px;
        font-size: 1em;
        font-family: 'Cormorant Garamond', serif;
        transition: all 0.3s ease;
        background: white;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #c9a961;
        box-shadow: 0 0 15px rgba(201, 169, 97, 0.2);
      }

      button[type="submit"] {
        width: 100%;
        padding: 18px;
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1.3em;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.4);
      }

      button[type="submit"]:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(201, 169, 97, 0.6);
      }

      .loader-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(107, 93, 79, 0.9);
        backdrop-filter: blur(10px);
        z-index: 10000;
        align-items: center;
        justify-content: center;
      }

      .loader-overlay.show {
        display: flex;
      }

      .loader-content {
        text-align: center;
      }

      .loader-spinner {
        width: 80px;
        height: 80px;
        border: 8px solid rgba(255, 255, 255, 0.2);
        border-top: 8px solid #c9a961;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      .loader-text {
        color: white;
        font-size: 1.3em;
        margin-top: 10px;
        font-family: 'Montserrat', sans-serif;
      }

      .loader-hearts {
        font-size: 2em;
        animation: loaderPulse 1.5s ease-in-out infinite;
      }

      @keyframes loaderPulse {

        0%,
        100% {
          transform: scale(1);
          opacity: 0.8;
        }

        50% {
          transform: scale(1.2);
          opacity: 1;
        }
      }

      .popup-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        z-index: 10001;
        padding: 20px;
      }

      .popup-box {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.7);
        background: linear-gradient(135deg, #faf8f0 0%, #ffffff 100%);
        padding: 40px 30px;
        border-radius: 30px;
        text-align: center;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        border: 4px solid #c9a961;
        animation: popupAppear 0.5s ease-out forwards;
        z-index: 10002;
      }

      @keyframes popupAppear {
        to {
          transform: translate(-50%, -50%) scale(1);
        }
      }

      .popup-icon {
        font-size: 60px;
        animation: popupBounce 1s ease-in-out infinite;
        margin-bottom: 20px;
      }

      @keyframes popupBounce {

        0%,
        100% {
          transform: translateY(0);
        }

        50% {
          transform: translateY(-15px);
        }
      }

      .popup-title {
        font-size: 2em;
        color: #a08763;
        margin-bottom: 15px;
        font-weight: 400;
        letter-spacing: 2px;
      }

      .popup-message {
        font-size: 1.2em;
        color: #6b5d4f;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .popup-close {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: none;
        padding: 15px 40px;
        border-radius: 25px;
        font-size: 1.2em;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.4);
        display: block;
        margin: 0 auto;
      }

      .popup-close:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(201, 169, 97, 0.6);
      }

      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background: #c9a961;
        animation: confettiFall 3s ease-out forwards;
      }

      @keyframes confettiFall {
        to {
          transform: translateY(500px) rotate(360deg);
          opacity: 0;
        }
      }

      footer {
        text-align: center;
        padding: 40px 20px;
        background: linear-gradient(135deg, #a08763 0%, #8a7456 100%);
        color: white;
        font-size: 1.2em;
        margin-top: 50px;
      }

      .audio-permission-popup {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        z-index: 10003;
      }

      .audio-permission-popup.show {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .audio-permission-box {
        background: linear-gradient(135deg, #faf8f0 0%, #ffffff 100%);
        padding: 40px 30px;
        border-radius: 20px;
        text-align: center;
        max-width: 450px;
        width: 100%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        border: 4px solid #c9a961;
      }

      .audio-permission-box h3 {
        color: #a08763;
        font-size: 1.8em;
        margin-bottom: 15px;
        font-weight: 400;
        letter-spacing: 2px;
        font-family: 'Cormorant Garamond', serif;
      }

      .audio-permission-box p {
        color: #6b5d4f;
        font-size: 1.15em;
        margin-bottom: 10px;
        line-height: 1.6;
      }

      .popup-icon-audio {
        font-size: 50px;
        animation: popupBounce 1s ease-in-out infinite;
        margin-bottom: 15px;
      }

      .audio-btn-yes {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 1em;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.4);
      }

      .audio-btn-yes:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(201, 169, 97, 0.6);
      }

      .audio-btn-no {
        background: #999;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 1em;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .audio-btn-no:hover {
        background: #777;
        transform: translateY(-2px);
      }

      .audio-control {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 9997;
      }

      .audio-toggle-btn {
        background: rgba(255, 255, 255, 0.9);
        border: 2px solid #c9a961;
        color: #a08763;
        padding: 10px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2em;
        transition: all 0.3s ease;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .audio-toggle-btn:hover {
        background: #faf8f0;
        transform: scale(1.1);
      }

      .audio-toggle-btn.muted {
        opacity: 0.6;
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2em;
        }

        .names {
          font-size: 2.5em;
        }

        .rings {
          font-size: 50px;
        }

        .date {
          font-size: 1.3em;
        }

        .countdown-box {
          min-width: 70px;
          padding: 15px 10px;
        }

        .countdown-number {
          font-size: 2em;
        }

        .info-box h2 {
          font-size: 1.5em;
          gap: 10px;
        }

        .icon {
          align-self: flex-start;
        }

        .hotel-list {
          line-height: 2.5;
        }

        .hotel-item {
          margin-bottom: 15px;
        }

        .hotel-item .phone-link {
          display: block;
          margin-top: 5px;
          margin-left: 24px;
        }

        .loader-spinner {
          width: 60px;
          height: 60px;
          border-width: 6px;
        }

        section {
          margin-top: -40px;
          padding: 40px 15px;
        }

        .language-switcher {
          top: 15px;
          right: 15px;
          padding: 8px 12px;
        }

        .lang-btn {
          padding: 6px 12px;
          font-size: 0.85em;
        }

        .audio-control {
          left: 15px;
          top: 80px;
        }

        .audio-permission-box {
          padding: 30px 20px;
        }

        .audio-permission-box h3 {
          font-size: 1.5em;
        }
		
		
		 /* Chatbot responsive styles */
    .chatbot-button {
        bottom: 20px;
        right: 20px;
        width: 55px;
        height: 55px;
    }

    .chatbot-button-icon {
        font-size: 24px;
    }

    .chatbot-notification {
        width: 18px;
        height: 18px;
        top: -4px;
        right: -4px;
    }

    .chatbot-window {
        bottom: 85px;
        right: 10px;
        left: 10px;
        width: auto;
        height: 70vh;
        max-height: 500px;
        border-radius: 15px;
    }

    .chatbot-header {
        padding: 15px;
    }

    .chatbot-header-title {
        font-size: 1em;
        gap: 8px;
    }

    .chatbot-close {
        font-size: 1.3em;
        width: 28px;
        height: 28px;
    }

    .chatbot-messages {
        padding: 15px;
        gap: 12px;
    }

    .chatbot-avatar {
        width: 30px;
        height: 30px;
        font-size: 1em;
    }

    .chatbot-bubble {
        font-size: 0.9em;
        padding: 10px 14px;
        max-width: 80%;
    }

    .chatbot-suggestions {
        gap: 6px;
        margin-top: 8px;
    }

    .chatbot-suggestion-btn {
        padding: 6px 10px;
        font-size: 0.8em;
        border-radius: 12px;
    }

    .chatbot-input-area {
        padding: 12px;
        gap: 8px;
    }

    .chatbot-input {
        padding: 10px;
        font-size: 0.9em;
        border-radius: 18px;
    }

    .chatbot-send {
        width: 36px;
        height: 36px;
        font-size: 1em;
        flex-shrink: 0;
    }

    .chatbot-typing {
        padding: 8px;
    }

    .chatbot-typing-dot {
        width: 6px;
        height: 6px;
    }
		
      }


@media (max-width: 374px) {
    .chatbot-window {
        height: 65vh;
        max-height: 450px;
        bottom: 80px;
    }

    .chatbot-header-title {
        font-size: 0.9em;
    }

    .chatbot-bubble {
        font-size: 0.85em;
    }

    .chatbot-suggestion-btn {
        font-size: 0.75em;
        padding: 5px 8px;
    }

    .chatbot-button {
        width: 50px;
        height: 50px;
        bottom: 15px;
        right: 15px;
    }

    .chatbot-button-icon {
        font-size: 22px;
    }
}


@media (min-width: 768px) and (max-width: 1024px) {
    .chatbot-window {
        width: 360px;
        height: 520px;
        bottom: 95px;
        right: 25px;
    }

    .chatbot-button {
        bottom: 25px;
        right: 25px;
    }
}


      @media (min-width: 768px) {
        .hotel-list {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px 30px;
          margin: 10px 0;
        }

        .hotel-item {
          display: inline-block;
          width: 100%;
        }

        .hotel-item br {
          display: block;
        }

        /* Rimuovi i 
						<br> tra gli hotel items su desktop */
        .hotel-list>br {
          display: none;
        }
      }

      /* Mobile: mantieni layout verticale */
      @media (max-width: 767px) {
        .hotel-list {
          display: block;
        }

        .hotel-item {
          display: block;
          margin-bottom: 10px;
        }
      }

      @media (max-width: 767px) {
        .audio-control {
          margin-top: 0;
          margin-bottom: 0;
          vertical-align: middle;
        }

        .language-switcher {
          margin-top: 0;
          margin-bottom: 0;
          vertical-align: middle;
        }
      }

      /* Chatbot Styles */
      .chatbot-button {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 5px 20px rgba(201, 169, 97, 0.5);
        z-index: 9996;
        transition: all 0.3s ease;
        border: 3px solid white;
      }

      .chatbot-button:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 30px rgba(201, 169, 97, 0.7);
      }

      .chatbot-button-icon {
        font-size: 28px;
        animation: chatbotPulse 2s ease-in-out infinite;
      }

      @keyframes chatbotPulse {

        0%,
        100% {
          transform: scale(1);
        }

        50% {
          transform: scale(1.1);
        }
      }

      .chatbot-notification {
        position: absolute;
        top: -5px;
        right: -5px;
        width: 20px;
        height: 20px;
        background: #e74c3c;
        border-radius: 50%;
        border: 2px solid white;
        animation: notificationBounce 1s ease-in-out infinite;
        display: none;
      }

      @keyframes notificationBounce {

        0%,
        100% {
          transform: scale(1);
        }

        50% {
          transform: scale(1.2);
        }
      }

      .chatbot-window {
        position: fixed;
        bottom: 100px;
        right: 30px;
        width: 380px;
        height: 550px;
        background: linear-gradient(135deg, #faf8f0 0%, #ffffff 100%);
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        border: 3px solid #c9a961;
        display: none;
        flex-direction: column;
        z-index: 9995;
        overflow: hidden;
        animation: chatbotSlideIn 0.3s ease-out;
      }

      .chatbot-window.show {
        display: flex;
      }

      @keyframes chatbotSlideIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .chatbot-header {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #b8945a;
      }

      .chatbot-header-title {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.1em;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .chatbot-close {
        background: transparent;
        border: none;
        color: white;
        font-size: 1.5em;
        cursor: pointer;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.3s ease;
      }

      .chatbot-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
      }

      .chatbot-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .chatbot-message {
        display: flex;
        gap: 10px;
        animation: messageSlideIn 0.3s ease-out;
      }

      @keyframes messageSlideIn {
        from {
          opacity: 0;
          transform: translateX(-10px);
        }

        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .chatbot-message.user {
        flex-direction: row-reverse;
      }

      .chatbot-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2em;
        flex-shrink: 0;
      }

      .chatbot-avatar.bot {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
      }

      .chatbot-avatar.user {
        background: linear-gradient(135deg, #a08763 0%, #8a7456 100%);
      }

      .chatbot-bubble {
        max-width: 75%;
        padding: 12px 16px;
        border-radius: 15px;
        font-size: 0.95em;
        line-height: 1.5;
        font-family: 'Cormorant Garamond', serif;
      }

      .chatbot-bubble.bot {
        background: white;
        border: 2px solid #e8dfc8;
        color: #6b5d4f;
      }

      .chatbot-bubble.user {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        color: white;
        border: 2px solid #b8945a;
      }

      .chatbot-suggestions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .chatbot-suggestion-btn {
        background: white;
        border: 2px solid #c9a961;
        color: #a08763;
        padding: 8px 12px;
        border-radius: 15px;
        font-size: 0.85em;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
      }

      .chatbot-suggestion-btn:hover {
        background: #c9a961;
        color: white;
        transform: translateY(-2px);
      }

      .chatbot-input-area {
        padding: 15px;
        background: white;
        border-top: 2px solid #e8dfc8;
        display: flex;
        gap: 10px;
      }

      .chatbot-input {
        flex: 1;
        padding: 12px;
        border: 2px solid #e8dfc8;
        border-radius: 20px;
        font-size: 0.95em;
        font-family: 'Cormorant Garamond', serif;
        outline: none;
        transition: all 0.3s ease;
      }

      .chatbot-input:focus {
        border-color: #c9a961;
      }

      .chatbot-send {
        background: linear-gradient(135deg, #c9a961 0%, #b8945a 100%);
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        font-size: 1.1em;
      }

      .chatbot-send:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 15px rgba(201, 169, 97, 0.4);
      }

      .chatbot-typing {
        display: flex;
        gap: 5px;
        padding: 10px;
      }

      .chatbot-typing-dot {
        width: 8px;
        height: 8px;
        background: #c9a961;
        border-radius: 50%;
        animation: typingDots 1.4s ease-in-out infinite;
      }

      .chatbot-typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }

      .chatbot-typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes typingDots {

        0%,
        60%,
        100% {
          transform: translateY(0);
          opacity: 0.7;
        }

        30% {
          transform: translateY(-10px);
          opacity: 1;
        }
      }

      .chatbot-window {
        bottom: 90px;
        right: 15px;
        left: 15px;
        width: auto;
        height: 500px;
      }

      .chatbot-button {
        bottom: 20px;
        right: 20px;
        width: 55px;
        height: 55px;
      }

      .chatbot-button-icon {
        font-size: 24px;
      }
    </style>
  </head>
  <body>
  <div class="envelope-container" id="envelopeContainer">
    <div class="envelope-wrapper" onclick="openEnvelope()">
      <div class="envelope-flap"></div>
      <div class="envelope-base"></div>
      <div class="envelope-letter">
        <div class="envelope-letter-title">Ornella & Francesco</div>
        <div class="envelope-letter-text lang-it">
          Siete invitati al nostro<br>
          matrimonio!<br>
          24 Agosto 2026
        </div>
        <div class="envelope-letter-text lang-en">
          You're invited to our<br>
          wedding!<br>
          August 24, 2026
        </div>
      </div>
      <div class="envelope-click-hint lang-it">‚ú® Clicca per aprire ‚ú®</div>
      <div class="envelope-click-hint lang-en">‚ú® Click to open ‚ú®</div>
    </div>
  </div>
  <div class="main-content" id="mainContent">
    <div id="sparkles"></div>
    <div class="language-switcher">
      <button class="lang-btn active" onclick="setLanguage('it')" id="btnIt">IT</button>
      <button class="lang-btn" onclick="setLanguage('en')" id="btnEn">EN</button>
    </div>
    <div class="audio-control" id="audioControl" style="display: none;">
      <button class="audio-toggle-btn" onclick="toggleMusic()" id="audioToggleBtn"> üîä </button>
    </div>
    <div class="hero">
      <div class="rings">üíç</div>
      <h1 class="lang-it">Siete Invitati</h1>
      <h1 class="lang-en">You Are Invited</h1>
      <h1 class="lang-it" style="font-size:1.5em; margin-top:10px;">Al Matrimonio di</h1>
      <h1 class="lang-en" style="font-size:1.5em; margin-top:10px;">To the Wedding of</h1>
      <div class="names"> Ornella <span class="ampersand">&</span> Francesco </div>
      <div class="date lang-it">24 Agosto 2026 - Ore 17:30</div>
      <div class="date lang-en">August 24, 2026 - 5:30 PM</div>
      <div class="countdown">
        <div class="countdown-box">
          <div class="countdown-number" id="days">0</div>
          <div class="countdown-label lang-it">Giorni</div>
          <div class="countdown-label lang-en">Days</div>
        </div>
        <div class="countdown-box">
          <div class="countdown-number" id="hours">0</div>
          <div class="countdown-label lang-it">Ore</div>
          <div class="countdown-label lang-en">Hours</div>
        </div>
        <div class="countdown-box">
          <div class="countdown-number" id="minutes">0</div>
          <div class="countdown-label lang-it">Minuti</div>
          <div class="countdown-label lang-en">Minutes</div>
        </div>
        <div class="countdown-box">
          <div class="countdown-number" id="seconds">0</div>
          <div class="countdown-label lang-it">Secondi</div>
          <div class="countdown-label lang-en">Seconds</div>
        </div>
      </div>
    </div>
    <div class="container">
      <section>
        <div class="section-content">
          <div class="info-box">
            <h2 class="lang-it">
              <span class="icon">‚õ™</span> Cerimonia e Ricevimento
            </h2>
            <h2 class="lang-en">
              <span class="icon">‚õ™</span> Ceremony and Reception
            </h2>
            <p class="lang-it">
              <strong>Dove:</strong> Villa Grandinetti (Nocera Terinese CZ) <br>
              <strong>Cerimonia in spiaggia:</strong> Ore 17:30 <br>
              <strong>Ricevimento:</strong> A seguire nello stesso luogo <br>
              <br>
              <a href="https://www.google.com/maps/dir//SS+18+Tirrena+Inferiore,+7,+88047+Nocera+Terinese+CZ/@39.0073919,16.0418774,16345m/data=!3m1!1e3!4m8!4m7!1m0!1m5!1m1!1s0x133fdd2e39b45c49:0xa1dfe416e157c3ca!2m2!1d16.1242783!2d39.0074209?entry=ttu&g_ep=EgoyMDI1MTAwMS4wIKXMDSoASAFQAw%3D%3D" target="_blank" class="maps-button">Apri in Google Maps</a>
            </p>
            <p class="lang-en">
              <strong>Where:</strong> Villa Grandinetti (Nocera Terinese CZ) <br>
              <strong>Beach Ceremony:</strong> 5:30 PM <br>
              <strong>Reception:</strong> Following at the same location <br>
              <br>
              <a href="https://www.google.com/maps/dir//SS+18+Tirrena+Inferiore,+7,+88047+Nocera+Terinese+CZ/@39.0073919,16.0418774,16345m/data=!3m1!1e3!4m8!4m7!1m0!1m5!1m1!1s0x133fdd2e39b45c49:0xa1dfe416e157c3ca!2m2!1d16.1242783!2d39.0074209?entry=ttu&g_ep=EgoyMDI1MTAwMS4wIKXMDSoASAFQAw%3D%3D" target="_blank" class="maps-button">Open in Google Maps</a>
            </p>
          </div>
          
		  <div class="info-box photo-upload-section">
    <h2 class="lang-it"><span class="icon">üì∏</span> Condividi i tuoi Ricordi</h2>
    <h2 class="lang-en"><span class="icon">üì∏</span> Share Your Memories</h2>
    
    <p class="lang-it">
        Aiutaci a raccogliere tutti i momenti speciali del nostro grande giorno!<br>
        Carica le tue foto e video del matrimonio.
    </p>
    <p class="lang-en">
        Help us collect all the special moments of our big day!<br>
        Upload your wedding photos and videos.
    </p>
    
    <a href="https://forms.gle/NbAdKbETepigJm2f8" target="_blank" class="upload-button lang-it">
        üì§ Carica le tue Foto
    </a>
    <a href="https://forms.gle/NbAdKbETepigJm2f8" target="_blank" class="upload-button lang-en">
        üì§ Upload Your Photos
    </a>
    
    <p class="upload-info lang-it">
        Accettiamo foto e video (max 10MB per file)
    </p>
    <p class="upload-info lang-en">
        We accept photos and videos (max 10MB per file)
    </p>
</div>
          <div class="info-box">
            <h2 class="lang-it">
              <span class="icon">‚úàÔ∏è</span> Viaggio di Nozze
            </h2>
            <h2 class="lang-en">
              <span class="icon">‚úàÔ∏è</span> Honeymoon
            </h2>
            <p class="lang-it" style="margin-bottom:20px">Il regalo pi√π grande per noi √® la vostra presenza! <br>Se desiderate contribuire al nostro viaggio di nozze, <br>saremo felici di ricevere il vostro pensiero. </p>
            <p class="lang-en" style="margin-bottom:20px">Your presence is the greatest gift! <br>If you wish to contribute to our honeymoon, <br>we would be delighted to receive your thoughtful gesture. </p>
            <div class="gift-reveal-container">
              <button class="gift-reveal-button lang-it" onclick="toggleGiftInfo()">Mostra dettagli</button>
              <button class="gift-reveal-button lang-en" onclick="toggleGiftInfo()">Show details</button>
              <div class="gift-info-hidden" id="giftInfo">
                <div class="gift-info-content">
                  <p class="lang-it" style="margin-bottom:15px;font-size:1.1em">Potete contribuire al nostro viaggio con un bonifico a:</p>
                  <p class="lang-en" style="margin-bottom:15px;font-size:1.1em">You can contribute to our trip with a bank transfer to:</p>
                  <div class="iban-box">
                    <strong class="lang-it">Intestatario:</strong>
                    <strong class="lang-en">Beneficiary:</strong> Francesco Frustaci & Ornella Barberio <br>
                    <strong>IBAN:</strong>
                    <span class="iban-code">LT12 3250 0874 1635 8434</span>
                    <br>
                    <strong class="lang-it">Causale:</strong>
                    <strong class="lang-en">Reference:</strong>
                    <span class="lang-it">Viaggio di nozze Francesco & Ornella</span>
                    <span class="lang-en">Honeymoon Francesco & Ornella</span>
                  </div>
                  <button class="copy-iban-btn lang-it" onclick="copyIban(event)">Copia IBAN</button>
                  <button class="copy-iban-btn lang-en" onclick="copyIban(event)">Copy IBAN</button>
                </div>
              </div>
            </div>
          </div>
		   <div class="info-box">
            <h2 class="lang-it">
              <span class="icon">‚ÑπÔ∏è</span> Informazioni Utili
            </h2>
            <h2 class="lang-en">
              <span class="icon">‚ÑπÔ∏è</span> Useful Information
            </h2>
            <p class="lang-it">
              <strong>Parcheggio:</strong> Disponibile presso la villa <br>
              <br>
              <strong>Hotel Consigliati:</strong>
              <br>
              <span class="hotel-list">
                <span class="hotel-item">üè® <strong>Acquamarina Hotel</strong> (300m) <br>
                  <a href="tel:+393487023136" class="phone-link">348 702 3136</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Palace Hotel</strong> (2km) <br>
                  <a href="tel:+390968932199" class="phone-link">0968 93219</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Hotel Lions</strong> (2km) <br>
                  <a href="tel:+390968999870" class="phone-link">0968 999870</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Crialesi Boutique Room</strong> (5km) <br>
                  <a href="tel:+393533412921" class="phone-link">353 341 2921</a>
                </span>
              </span>
              <br>
              <br>
              <strong>RSVP entro il 15 Luglio 2026 al numero:</strong>
              <br>
              <a href="tel:+393461743240" class="phone-link">3461743240</a> (Ornella) o <a href="tel:+393392165378" class="phone-link">3392165378</a> (Francesco) <br>
              <strong>o compilando il modulo qui sotto:</strong>
              <br>
            </p>
            <p class="lang-en">
              <strong>Parking:</strong> Available at the venue <br>
              <br>
              <strong>Recommended Hotels:</strong>
              <br>
              <span class="hotel-list">
                <span class="hotel-item">üè® <strong>Acquamarina Hotel</strong> (300m) <br>
                  <a href="tel:+393487023136" class="phone-link">348 702 3136</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Palace Hotel</strong> (2km) <br>
                  <a href="tel:+390968932199" class="phone-link">0968 93219</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Hotel Lions</strong> (2km) <br>
                  <a href="tel:+390968999870" class="phone-link">0968 999870</a>
                </span>
                <br>
                <span class="hotel-item">üè® <strong>Crialesi Boutique Room</strong> (5km) <br>
                  <a href="tel:+393533412921" class="phone-link">353 341 2921</a>
                </span>
              </span>
              <br>
              <br>
              <strong>RSVP by 15th July 2026 to:</strong>
              <br>
              <a href="tel:+393461743240" class="phone-link">3461743240</a> (Ornella) or <a href="tel:+393392165378" class="phone-link">3392165378</a> (Francesco) <br>
              <strong>or fill in the form below :</strong>
              <br>
            </p>
          </div>
          <div class="rsvp-form">
            <h2 class="lang-it">Conferma la tua Presenza</h2>
            <h2 class="lang-en">Confirm Your Attendance</h2>
            <form id="rsvpForm">
              <div class="form-group">
                <label class="lang-it">Nome e Cognome *</label>
                <label class="lang-en">Full Name *</label>
                <input type="text" name="nome" required>
              </div>
              <div class="form-group">
                <label class="lang-it">Telefono</label>
                <label class="lang-en">Phone</label>
                <input type="tel" name="telefono">
              </div>
              <div class="form-group">
                <label class="lang-it">Parteciper√≤ *</label>
                <label class="lang-en">I will attend *</label>
                <select name="presenza" id="presenzaSelect" onchange="handlePresenzaChange()" required></select>
              </div>
              <div class="form-group">
                <label class="lang-it">Numero di adulti *</label>
                <label class="lang-en">Number of adults *</label>
                <input type="number" id="numAdulti" name="adulti" min="1" max="10" value="0" required>
              </div>
              <div class="form-group">
                <label class="lang-it">Numero di bambini</label>
                <label class="lang-en">Number of children</label>
                <input type="number" id="numBambini" name="bambini" min="0" max="10" value="0">
              </div>
              <div class="form-group" id="menuContainer"></div>
              <div class="form-group">
                <label class="lang-it">Intolleranze o allergie alimentari</label>
                <label class="lang-en">Food intolerances or allergies</label>
                <textarea name="intolleranze" rows="3" id="intolleranze"></textarea>
              </div>
              <div class="form-group">
                <label class="lang-it">Un messaggio per noi</label>
                <label class="lang-en">A message for us</label>
                <textarea name="messaggio" rows="4" id="messaggio"></textarea>
              </div>
              <button type="submit" class="lang-it">Invia Conferma</button>
              <button type="submit" class="lang-en">Send Confirmation</button>
            </form>
          </div>
        </div>
      </section>
    </div>
    <div class="loader-overlay" id="loaderOverlay">
      <div class="loader-content">
        <div class="loader-spinner"></div>
        <div class="loader-hearts">üíç ‚ú® üíç</div>
        <div class="loader-text lang-it">Invio in corso...</div>
        <div class="loader-text lang-en">Sending...</div>
      </div>
    </div>
    <div class="popup-overlay" id="popupOverlay">
      <div class="popup-box" id="popupBox">
        <div class="popup-icon">‚ú®üíç‚ú®</div>
        <h2 class="popup-title lang-it">Grazie!</h2>
        <h2 class="popup-title lang-en">Thank you!</h2>
        <p class="popup-message lang-it">La tua conferma √® stata ricevuta con successo! <br>Non vediamo l'ora di festeggiare insieme a te! </p>
        <p class="popup-message lang-en">Your confirmation has been received successfully! <br>We can't wait to celebrate with you! </p>
        <button class="popup-close lang-it" onclick="closePopup()">Perfetto!</button>
        <button class="popup-close lang-en" onclick="closePopup()">Perfect!</button>
      </div>
    </div>
    <!-- Chatbot -->
    <div class="chatbot-button" id="chatbotButton" onclick="toggleChatbot()">
      <div class="chatbot-button-icon">üí¨</div>
      <div class="chatbot-notification" id="chatbotNotification"></div>
    </div>
    <div class="chatbot-window" id="chatbotWindow">
      <div class="chatbot-header">
        <div class="chatbot-header-title">
          <span>üíç</span>
          <span class="lang-it">Assistente Matrimonio</span>
          <span class="lang-en">Wedding Assistant</span>
        </div>
        <button class="chatbot-close" onclick="toggleChatbot()">√ó</button>
      </div>
      <div class="chatbot-messages" id="chatbotMessages"></div>
      <div class="chatbot-input-area">
        <input type="text" class="chatbot-input lang-it" id="chatbotInputIt" placeholder="Scrivi una domanda...">
        <input type="text" class="chatbot-input lang-en" id="chatbotInputEn" placeholder="Ask a question..." style="display:none;">
        <button class="chatbot-send" onclick="sendChatMessage()">‚û§</button>
      </div>
    </div>
    <footer>
      <p class="lang-it">Non vediamo l'ora di festeggiare con voi!</p>
      <p class="lang-en">We can't wait to celebrate with you!</p>
      <p style="font-size:0.9em;margin-top:10px">
        <span class="lang-it"> Ornella e Francesco</span>
        <span class="lang-en"> Ornella e Francesco</span>
      </p>
    </footer>
	</div>
    <audio id="backgroundMusic" loop>
      <source src="songs.mp3" type="audio/mpeg">
    </audio>
    <div class="audio-permission-popup" id="audioPermission">
      <div class="audio-permission-box">
        <div class="popup-icon-audio">üéµ</div>
        <h3 class="lang-it">Ascolta la nostra canzone</h3>
        <h3 class="lang-en">Listen to our song</h3>
        <p class="lang-it">Vuoi ascoltare la musica mentre navighi il sito?</p>
        <p class="lang-en">Would you like to listen to music while browsing?</p>
        <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
          <button class="audio-btn-yes lang-it" onclick="startMusic()"> S√¨, attiva la musica! üé∂ </button>
          <button class="audio-btn-yes lang-en" onclick="startMusic()"> Yes, play music! üé∂ </button>
          <button class="audio-btn-no" onclick="declineMusic()">
            <span class="lang-it">No, grazie</span>
            <span class="lang-en">No, thanks</span>
          </button>
        </div>
      </div>
    </div>
    <script>
 let audio;
 let isPlaying = false;
 let chatbotOpen = false;
 let hasSeenChatbot = false;
let envelopeOpened = false;

function openEnvelope() {
  if (envelopeOpened) return;
  envelopeOpened = true;
  
   if (typeof gtag !== 'undefined') {
    gtag('event', 'apertura_busta', {
      'event_category': 'engagement',
      'event_label': 'Invito Matrimonio'
    });
  }
  
  
  const container = document.getElementById('envelopeContainer');
  const mainContent = document.getElementById('mainContent');
  
  // Nascondi l'envelope
  container.classList.add('hide');
  
  // Mostra il contenuto principale dopo un breve ritardo
  setTimeout(() => {
    mainContent.classList.add('show');
    document.body.classList.add('envelope-open');
    
    // Mostra il popup per la musica dopo che l'envelope √® aperto
    setTimeout(() => {
      showAudioPermission();
    }, 500);
  }, 800);
  
  }




 const knowledgeBase = {
 	it: {
 		greetings: ['ciao', 'salve', 'buongiorno', 'buonasera', 'hey', 'hello'],
 		responses: {
 			greeting: 'üëã Ciao! Sono qui per aiutarti con le informazioni sul matrimonio di Ornella e Francesco. Cosa vorresti sapere?',
 			location: 'üìç Il matrimonio si terr√† presso Villa Grandinetti a Nocera Terinese (CZ). La cerimonia in spiaggia inizia alle 17:30, seguita dal ricevimento nello stesso luogo.',
 			date: 'üìÖ Il matrimonio √® il 24 Agosto 2026 alle ore 17:30.',
 			hotels: 'üè® Hotel consigliati nelle vicinanze:\n- Acquamarina Hotel (300m) - 348 702 3136\n- Palace Hotel (2km) - 0968 93219\n- Hotel Lions (2km) - 0968 999870\n- Crialesi Boutique Room (5km) - 353 341 2921',
 			parking: 'üöó √à disponibile un parcheggio gratuito presso Villa Grandinetti.',
 			rsvp: '‚úâÔ∏è Conferma la tua presenza entro il 15 Luglio 2026 chiamando:\n- Ornella: 3461743240\n- Francesco: 3392165378\nOppure compila il modulo RSVP in fondo alla pagina!',
 			gift: 'üéÅ La vostra presenza √® il regalo pi√π grande! Se desiderate contribuire al nostro viaggio di nozze, potete fare un bonifico. Clicca su "Mostra dettagli" nella sezione Regalo per vedere l\'IBAN.',
 			menu: 'üçΩÔ∏è Offriamo menu diversi: pesce, carne, vegetariano e vegano. Potrai indicare la tua preferenza nel modulo RSVP. C\'√® anche un menu dedicato per i bambini.',
 			children: 'üë∂ I bambini sono benvenuti! Abbiamo un menu speciale per loro e potrai indicare eventuali allergie nel modulo RSVP.',
 			allergies: '‚ö†Ô∏è Nel modulo RSVP c\'√® uno spazio dedicato per segnalare intolleranze e allergie alimentari. Faremo in modo di soddisfare tutte le esigenze!',
 			contact: 'üìû Contatti:\n- Ornella: 3461743240\n- Francesco: 3392165378\nNon esitare a chiamarci per qualsiasi domanda!',
			photos: 'üì∏ Puoi caricare le tue foto del matrimonio cliccando sul pulsante "Carica le tue Foto" nella sezione dedicata della pagina!',
 			directions: 'üó∫Ô∏è Puoi trovare Villa Grandinetti su Google Maps cliccando il pulsante "Apri in Google Maps" nella sezione Cerimonia.',
 			default: 'Mi dispiace, non ho capito bene la tua domanda. Ecco alcuni argomenti su cui posso aiutarti:'
 		},
 		suggestions: [
 			'Dove si svolge?',
 			'Quando √® il matrimonio?',
 			'Hotel consigliati',
 			'Come confermo?',
 			'Info sui regali',
			'Come carico le foto?'
 		]
 	},
 	en: {
 		greetings: ['hi', 'hello', 'hey', 'good morning', 'good evening'],
 		responses: {
 			greeting: 'üëã Hello! I\'m here to help you with information about Ornella and Francesco\'s wedding. What would you like to know?',
 			location: 'üìç The wedding will be held at Villa Grandinetti in Nocera Terinese (CZ). The beach ceremony starts at 5:30 PM, followed by the reception at the same venue.',
 			date: 'üìÖ The wedding is on August 24, 2026 at 5:30 PM.',
			hotels: 'üè® Recommended hotels nearby:\n- Acquamarina Hotel (300m) - 348 702 3136\n- Palace Hotel (2km) - 0968 93219\n- Hotel Lions (2km) - 0968 999870\n- Crialesi Boutique Room (5km) - 353 341 2921',
 			parking: 'üöó Free parking is available at Villa Grandinetti.',
 			rsvp: '‚úâÔ∏è Please confirm your attendance by July 15, 2026 by calling:\n- Ornella: 3461743240\n- Francesco: 3392165378\nOr fill out the RSVP form at the bottom of the page!',
 			gift: 'üéÅ Your presence is the greatest gift! If you wish to contribute to our honeymoon, you can make a bank transfer. Click "Show details" in the Gift section to see the IBAN.',
 			menu: 'üçΩÔ∏è We offer different menus: fish, meat, vegetarian and vegan. You can indicate your preference in the RSVP form. There\'s also a special menu for children.',
 			children: 'üë∂ Children are welcome! We have a special menu for them and you can indicate any allergies in the RSVP form.',
 			allergies: '‚ö†Ô∏è The RSVP form has a dedicated space to report food intolerances and allergies. We will make sure to meet all needs!',
 			contact: 'üìû Contacts:\n- Ornella: 3461743240\n- Francesco: 3392165378\nDon\'t hesitate to call us for any questions!',
			photos: 'üì∏ You can upload your wedding photos by clicking the "Upload Your Photos" button in the dedicated section on the page!',
 			directions: 'üó∫Ô∏è You can find Villa Grandinetti on Google Maps by clicking the "Open in Google Maps" button in the Ceremony section.',
 			default: 'I\'m sorry, I didn\'t quite understand your question. Here are some topics I can help you with:'
 		},
 		suggestions: [
 			'Where is it?',
 			'When is the wedding?',
 			'Recommended hotels',
 			'How to RSVP?',
 			'Gift info',
			'How to upload photos?'
 		]
 	}
 };

 function initChatbot() {
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const welcomeMessage = lang === 'en' ?
 		'üëã Hello! I\'m the wedding assistant. Ask me anything about Ornella and Francesco\'s big day!' :
 		'üëã Ciao! Sono l\'assistente del matrimonio. Chiedimi tutto su questo grande giorno di Ornella e Francesco!';

 	addBotMessage(welcomeMessage, true);

 	// Show notification after 3 seconds
 	if (!hasSeenChatbot) {
 		setTimeout(() => {
 			document.getElementById('chatbotNotification').style.display = 'block';
 		}, 3000);
 	}
 }

 function toggleChatbot() {
 	const chatbot = document.getElementById('chatbotWindow');
 	const button = document.getElementById('chatbotButton');
 	const notification = document.getElementById('chatbotNotification');
	
	if (chatbotOpen && typeof gtag !== 'undefined') {
    gtag('event', 'apertura_chatbot', {
      'event_category': 'engagement',
      'event_label': 'Assistente Matrimonio'
    });
  }
	

 	chatbotOpen = !chatbotOpen;

 	if (chatbotOpen) {
 		chatbot.classList.add('show');
 		button.style.display = 'none';
 		notification.style.display = 'none';
 		hasSeenChatbot = true;

 		// Focus input
 		const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 		const inputId = lang === 'en' ? 'chatbotInputEn' : 'chatbotInputIt';
 		document.getElementById(inputId).focus();

 		// Scroll to bottom
 		scrollChatToBottom();
 	} else {
 		chatbot.classList.remove('show');
 		button.style.display = 'flex';
 	}
 }

 function addBotMessage(message, withSuggestions = false) {
 	const messagesDiv = document.getElementById('chatbotMessages');
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';

 	const messageDiv = document.createElement('div');
 	messageDiv.className = 'chatbot-message bot';

 	messageDiv.innerHTML = `
        <div class="chatbot-avatar bot">üíç</div>
        <div>
            <div class="chatbot-bubble bot">${message.replace(/\n/g, '<br>')}</div>
            ${withSuggestions ? `
                <div class="chatbot-suggestions">
                    ${knowledgeBase[lang].suggestions.map(s => 
                        `<button class="chatbot-suggestion-btn" onclick="handleSuggestion('${s}')">${s}</button>`
                    ).join('')}
                </div>
            ` : ''}
        </div>
    `;

 	messagesDiv.appendChild(messageDiv);
 	scrollChatToBottom();
 }

 function addUserMessage(message) {
 	const messagesDiv = document.getElementById('chatbotMessages');

 	const messageDiv = document.createElement('div');
 	messageDiv.className = 'chatbot-message user';

 	messageDiv.innerHTML = `
        <div class="chatbot-avatar user">üë§</div>
        <div class="chatbot-bubble user">${message}</div>
    `;

 	messagesDiv.appendChild(messageDiv);
 	scrollChatToBottom();
 }

 function showTyping() {
 	const messagesDiv = document.getElementById('chatbotMessages');

 	const typingDiv = document.createElement('div');
 	typingDiv.className = 'chatbot-message bot';
 	typingDiv.id = 'typingIndicator';

 	typingDiv.innerHTML = `
        <div class="chatbot-avatar bot">üíç</div>
        <div class="chatbot-bubble bot">
            <div class="chatbot-typing">
                <div class="chatbot-typing-dot"></div>
                <div class="chatbot-typing-dot"></div>
                <div class="chatbot-typing-dot"></div>
            </div>
        </div>
    `;

 	messagesDiv.appendChild(typingDiv);
 	scrollChatToBottom();
 }

 function hideTyping() {
 	const typing = document.getElementById('typingIndicator');
 	if (typing) typing.remove();
 }

 function scrollChatToBottom() {
 	const messagesDiv = document.getElementById('chatbotMessages');
 	setTimeout(() => {
 		messagesDiv.scrollTop = messagesDiv.scrollHeight;
 	}, 100);
 }

 function getResponse(userMessage) {
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const kb = knowledgeBase[lang];
 	const msg = userMessage.toLowerCase();

 	// Check greetings
 	if (kb.greetings.some(g => msg.includes(g))) {
 		return kb.responses.greeting;
 	}

 	// Check keywords
 	const keywords = {
 		location: ['dove', 'luogo', 'posto', 'villa', 'where', 'location', 'place', 'venue', 'svolge', 'held'],
 		date: ['quando', 'data', 'giorno', 'ora', 'orario', 'when', 'date', 'time', 'che giorno'],
 		hotels: ['hotel', 'alloggio', 'dormire', 'accommodation', 'stay', 'sleep', 'dove dormire', 'where to stay'],
 		parking: ['parcheggio', 'macchina', 'auto', 'parking', 'car', 'posteggio'],
 		rsvp: ['conferma', 'confermo', 'confermare', 'risposta', 'rispondere', 'partecipare', 'partecipo', 'venire', 'vengo', 'presenza', 'rsvp', 'confirm', 'attendance', 'come faccio a confermare', 'devo confermare', 'how do i confirm'],
 		gift: ['regalo', 'regali', 'viaggio', 'nozze', 'gift', 'honeymoon', 'present', 'contribuire', 'contribute', 'luna di miele', 'iban'],
 		menu: ['menu', 'men√π', 'cibo', 'mangiare', 'food', 'eat', 'meal', 'cosa si mangia', 'what food'],
 		children: ['bambini', 'bambino', 'figli', 'figlio', 'children', 'kids', 'child'],
 		allergies: ['allergie', 'allergia', 'intolleranze', 'intolleranza', 'allergies', 'intolerances', 'celiaco', 'celiac'],
 		contact: ['contatto', 'contatti', 'telefono', 'chiamare', 'contact', 'phone', 'call', 'numero', 'telefonare'],
		photos: ['foto', 'fotografie', 'immagini', 'video', 'caricare', 'carico', 'photos', 'pictures', 'images', 'upload', 'share', 'condividere', 'ricordi', 'memories', 'scaricare'],
 		directions: ['arrivare', 'arrivo', 'indicazioni', 'strada', 'directions', 'how to get', 'navigate', 'come arrivo', 'come raggiungo'],
		
 	};

 	    // Calcola punteggio per ogni categoria
    const scores = {};
    for (const [key, words] of Object.entries(keywords)) {
        scores[key] = 0;
        for (const word of words) {
            // Usa word boundary per match preciso
            const regex = new RegExp('\\b' + word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '\\b', 'i');
            if (regex.test(msg)) {
                scores[key]++;
            }
        }
    }

    // Trova la categoria con punteggio pi√π alto
    let maxScore = 0;
    let bestMatch = null;
    for (const [key, score] of Object.entries(scores)) {
        if (score > maxScore) {
            maxScore = score;
            bestMatch = key;
        }
    }

    // Se c'√® un match, ritorna la risposta
    if (bestMatch && maxScore > 0) {
        return kb.responses[bestMatch];
    }

    return kb.responses.default;
}

 function sendChatMessage() {
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const inputId = lang === 'en' ? 'chatbotInputEn' : 'chatbotInputIt';
 	const input = document.getElementById(inputId);
 	const message = input.value.trim();

 	if (!message) return;

 	// Add user message
 	addUserMessage(message);
 	input.value = '';

 	// Show typing
 	showTyping();

 	// Simulate delay and respond
 	setTimeout(() => {
 		hideTyping();
 		const response = getResponse(message);
 		const showSuggestions = response.includes('non ho capito') || response.includes('didn\'t quite understand');
 		addBotMessage(response, showSuggestions);
 	}, 800 + Math.random() * 400);
 }

 function handleSuggestion(suggestion) {
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const inputId = lang === 'en' ? 'chatbotInputEn' : 'chatbotInputIt';
 	const input = document.getElementById(inputId);
 	input.value = suggestion;
 	sendChatMessage();
 }




 function updateCountdown() {
 	const weddingDate = new Date('2026-08-24T18:00:00').getTime();
 	const now = new Date().getTime();
 	const distance = weddingDate - now;
 	if (distance > 0) {
 		document.getElementById('days').textContent = Math.floor(distance / (1000 * 60 * 60 * 24));
 		document.getElementById('hours').textContent = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
 		document.getElementById('minutes').textContent = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
 		document.getElementById('seconds').textContent = Math.floor((distance % (1000 * 60)) / 1000);
 	}
 }

 function createSparkles() {
 	const container = document.getElementById('sparkles');
 	container.innerHTML = '';
 	for (let i = 0; i < (window.innerWidth < 768 ? 15 : 30); i++) {
 		const sparkle = document.createElement('div');
 		sparkle.className = 'sparkle';
 		sparkle.style.left = Math.random() * 100 + '%';
 		sparkle.style.animationDelay = Math.random() * 4 + 's';
 		sparkle.style.animationDuration = (Math.random() * 3 + 2) + 's';
 		container.appendChild(sparkle);
 	}
 }

 function animateOnScroll() {
 	document.querySelectorAll('.info-box').forEach(box => {
 		if (box.getBoundingClientRect().top < window.innerHeight * 0.8) box.classList.add('visible');
 	});
 }

 function showLoader() {
 	document.getElementById('loaderOverlay').classList.add('show');
 }

 function hideLoader() {
 	document.getElementById('loaderOverlay').classList.remove('show');
 }

 function populatePresenzaSelect() {
 	const select = document.getElementById('presenzaSelect');
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const saved = select.value;
 	select.innerHTML = lang === 'en' ? '<option value="">Select...</option><option value="yes">Yes, I\'ll be there!</option><option value="no">Sorry, I can\'t make it</option>' : '<option value="">Seleziona...</option><option value="si">S√¨, ci sar√≤!</option><option value="no">Mi dispiace, non potr√≤</option>';
 	if (saved === 'no') select.value = 'no';
 	else if ((saved === 'si' && lang === 'it') || (saved === 'yes' && lang === 'en')) select.value = saved;
 	else if (saved === 'si' && lang === 'en') select.value = 'yes';
 	else if (saved === 'yes' && lang === 'it') select.value = 'si';
 }

 function handlePresenzaChange() {
 	const presenza = document.querySelector('select[name="presenza"]').value;
 	const numAdultiInput = document.getElementById('numAdulti');
 	const numBambiniInput = document.getElementById('numBambini');
 	const intolleranzeTextarea = document.querySelector('textarea[name="intolleranze"]');

 	if (presenza === 'no') {
 		// Risposta negativa - disabilita campi
 		numAdultiInput.value = 0;
 		numAdultiInput.min = 0;
 		numAdultiInput.disabled = true;
 		numBambiniInput.value = 0;
 		numBambiniInput.min = 0;
 		numBambiniInput.disabled = true;
 		intolleranzeTextarea.disabled = true;
 		intolleranzeTextarea.value = '';
 	} else if (presenza === 'si' || presenza === 'yes') {
 		// Risposta positiva - abilita campi
 		numAdultiInput.value = 1;
 		numAdultiInput.min = 1;
 		numAdultiInput.disabled = false;
 		numBambiniInput.value = 0;
 		numBambiniInput.min = 0;
 		numBambiniInput.disabled = false;
 		intolleranzeTextarea.disabled = false;
 	}
 	generateMenuFields();
 }

 function generateMenuFields() {
 	const numAdulti = parseInt(document.getElementById('numAdulti').value) || 0;
 	const numBambini = parseInt(document.getElementById('numBambini').value) || 0;
 	const container = document.getElementById('menuContainer');
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
 	const saved = {};
 	container.querySelectorAll('select').forEach(s => saved[s.name] = s.value);
 	container.innerHTML = '';
 	if (numAdulti + numBambini === 0) return;
 	const title = document.createElement('label');
 	title.style.fontSize = '1.2em';
 	title.style.marginBottom = '15px';
 	title.style.display = 'block';
 	title.innerHTML = lang === 'en' ? 'Menu Preferences * <span style="font-size:0.85em;color:#999;font-weight:normal;">(one per person)</span>' : 'Preferenze Menu * <span style="font-size:0.85em;color:#999;font-weight:normal;">(una per persona)</span>';
 	container.appendChild(title);
 	for (let i = 1; i <= numAdulti; i++) {
 		const div = document.createElement('div');
 		div.className = 'menu-selection';
 		div.innerHTML = '<h3>' + (lang === 'en' ? 'üë§ Adult ' + i : 'üë§ Adulto ' + i) + '</h3>';
 		const select = document.createElement('select');
 		select.name = 'menu_adulto_' + i;
 		select.required = true;
 		select.innerHTML = lang === 'en' ? '<option value="">Select...</option><option value="fish">Fish Menu</option><option value="meat">Meat Menu</option><option value="vegetarian">Vegetarian</option><option value="vegan">Vegan</option>' : '<option value="">Seleziona...</option><option value="pesce">Menu Pesce</option><option value="carne">Menu Carne</option><option value="vegetariano">Vegetariano</option><option value="vegano">Vegano</option>';
 		if (saved[select.name]) select.value = saved[select.name];
 		div.appendChild(select);
 		container.appendChild(div);
 	}
 	for (let i = 1; i <= numBambini; i++) {
 		const div = document.createElement('div');
 		div.className = 'menu-selection';
 		div.innerHTML = '<h3>' + (lang === 'en' ? 'üë∂ Child ' + i : 'üë∂ Bambino ' + i) + '</h3>';
 		const select = document.createElement('select');
 		select.name = 'menu_bambino_' + i;
 		select.required = true;
 		select.innerHTML = lang === 'en' ? '<option value="">Select...</option><option value="children">Children\'s Menu</option><option value="fish">Fish Menu</option><option value="meat">Meat Menu</option><option value="vegetarian">Vegetarian</option><option value="vegan">Vegan</option>' : '<option value="">Seleziona...</option><option value="bambini">Menu Bambini</option><option value="pesce">Menu Pesce</option><option value="carne">Menu Carne</option><option value="vegetariano">Vegetariano</option><option value="vegano">Vegano</option>';
 		if (saved[select.name]) select.value = saved[select.name];
 		div.appendChild(select);
 		container.appendChild(div);
 	}
 }

 document.getElementById('numAdulti').addEventListener('change', generateMenuFields);
 document.getElementById('numBambini').addEventListener('change', generateMenuFields);

 document.getElementById('rsvpForm').addEventListener('submit', async function(e) {
 	e.preventDefault();
	
	
	
 	showLoader();
 	const formData = new FormData(this);
 	const numAdulti = parseInt(formData.get('adulti')) || 0;
 	const numBambini = parseInt(formData.get('bambini')) || 0;
 	const presenza = formData.get('presenza');

if (typeof gtag !== 'undefined') {
    gtag('event', 'conferma_presenza', {
      'event_category': 'conversion',
      'event_label': presenza,
      'value': parseInt(numAdulti)
    });
  }
	 
 	let menuPreferences = [];
 	for (let i = 1; i <= numAdulti; i++) {
 		const menu = formData.get('menu_adulto_' + i);
 		if (menu) menuPreferences.push('Adulto ' + i + ': ' + menu);
 	}
 	for (let i = 1; i <= numBambini; i++) {
 		const menu = formData.get('menu_bambino_' + i);
 		if (menu) menuPreferences.push('Bambino ' + i + ': ' + menu);
 	}
 	const data = {
 		nome: formData.get('nome'),
 		email: 'N.D',
 		telefono: formData.get('telefono'),
 		presenza: formData.get('presenza'),
 		adulti: formData.get('adulti'),
 		bambini: formData.get('bambini'),
 		menu: menuPreferences.join(' | '),
 		intolleranze: formData.get('intolleranze'),
 		messaggio: formData.get('messaggio')
 	};
 	try {
 		await Promise.all([
 			fetch('https://script.google.com/macros/s/AKfycbxaQ8VInL_hg2x5o9rWsFN3XZfJ2QgPzxL7aNLRd1-8V7Xk_H5NHja4nBoEBFkl2dHlmw/exec', {
 				method: 'POST',
 				mode: 'no-cors',
 				headers: {
 					'Content-Type': 'application/json'
 				},
 				body: JSON.stringify(data)
 			}),
 			new Promise(resolve => setTimeout(resolve, 1500))
 		]);
 		hideLoader();
 		showPopup(presenza === 'no');
 		this.reset();
 		populatePresenzaSelect();
 		// Re-abilita i campi dopo il reset
 		document.getElementById('numAdulti').disabled = false;
 		document.getElementById('numBambini').disabled = false;
 		document.querySelector('textarea[name="intolleranze"]').disabled = false;
 	} catch (error) {
 		hideLoader();
 		alert('Si √® verificato un errore. Riprova pi√π tardi.');
 	}
 });

 function showPopup(isNegativeResponse) {
 	const popupOverlay = document.getElementById('popupOverlay');
 	const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';

 	// Modifica il messaggio in base alla risposta
 	const messageIt = document.querySelector('.popup-message.lang-it');
 	const messageEn = document.querySelector('.popup-message.lang-en');

 	if (isNegativeResponse) {
 		messageIt.innerHTML = 'La tua risposta √® stata ricevuta con successo!<br>Ci dispiace che non potrai esserci, ma ti ringraziamo per averci fatto sapere.';
 		messageEn.innerHTML = 'Your response has been received successfully!<br>We\'re sorry you can\'t make it, but thank you for letting us know.';
 	} else {
 		messageIt.innerHTML = 'La tua conferma √® stata ricevuta con successo!<br>Non vediamo l\'ora di festeggiare insieme a te!';
 		messageEn.innerHTML = 'Your confirmation has been received successfully!<br>We can\'t wait to celebrate with you!';
 	}

 	popupOverlay.style.display = 'block';
 	if (!isNegativeResponse) {
 		createConfetti();
 	}
 }

 function closePopup() {
 	document.getElementById('popupOverlay').style.display = 'none';
 }

 function createConfetti() {
 	const popup = document.getElementById('popupBox');
 	const colors = ['#c9a961', '#b8945a', '#d4af6a', '#a08763'];
 	for (let i = 0; i < (window.innerWidth < 768 ? 30 : 50); i++) {
 		const confetti = document.createElement('div');
 		confetti.className = 'confetti';
 		confetti.style.left = Math.random() * 100 + '%';
 		confetti.style.top = '-10px';
 		confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
 		confetti.style.animationDelay = Math.random() * 0.5 + 's';
 		popup.appendChild(confetti);
 		setTimeout(() => confetti.remove(), 3000);
 	}
 }

 document.getElementById('popupOverlay').addEventListener('click', function(e) {
 	if (e.target === this) closePopup();
 });

 function toggleGiftInfo() {
 	const info = document.getElementById('giftInfo');
 	const btnIt = document.querySelector('.gift-reveal-button.lang-it');
 	const btnEn = document.querySelector('.gift-reveal-button.lang-en');

 	info.classList.toggle('show');

 	if (info.classList.contains('show')) {
 		btnIt.textContent = 'Nascondi dettagli';
 		btnEn.textContent = 'Hide details';
 	} else {
 		btnIt.textContent = 'Mostra dettagli';
 		btnEn.textContent = 'Show details';
 	}
 }

 function setCookie(name, value, days) {
 	const d = new Date();
 	d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
 	document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/";
 }

 function getCookie(name) {
 	const nameEQ = name + "=";
 	const ca = document.cookie.split(';');
 	for (let i = 0; i < ca.length; i++) {
 		let c = ca[i];
 		while (c.charAt(0) == ' ') c = c.substring(1);
 		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length);
 	}
 	return null;
 }

 function setLanguage(lang) {
	if (typeof gtag !== 'undefined') {
    gtag('event', 'cambio_lingua', {
      'event_category': 'engagement',
      'event_label': lang
    });
  }
 
 
 	if (lang === 'en') {
 		document.body.classList.add('lang-english');
 		document.getElementById('btnIt').classList.remove('active');
 		document.getElementById('btnEn').classList.add('active');
 	} else {
 		document.body.classList.remove('lang-english');
 		document.getElementById('btnIt').classList.add('active');
 		document.getElementById('btnEn').classList.remove('active');
 	}
 	setCookie('language', lang, 365);
 	updateTextareaPlaceholders(lang);
 	populatePresenzaSelect();
 	generateMenuFields();
	reloadChatbot();
 }

 function updateTextareaPlaceholders(lang) {
 	const intolleranze = document.getElementById('intolleranze');
 	const messaggio = document.getElementById('messaggio');
 	if (lang === 'en') {
 		intolleranze.placeholder = 'E.g.: lactose, gluten, nuts...';
 		messaggio.placeholder = 'Leave us a special message...';
 	} else {
 		intolleranze.placeholder = 'Es: lattosio, glutine, frutta secca...';
 		messaggio.placeholder = 'Lasciaci un messaggio speciale...';
 	}
 }

 function loadSavedLanguage() {
 	const saved = getCookie('language');
 	setLanguage(saved === 'en' ? 'en' : 'it');
 }

 function copyIban(event) {
 	const iban = 'LT123250087416358434';
 	navigator.clipboard.writeText(iban).then(function() {
	
	
	 if (typeof gtag !== 'undefined') {
      gtag('event', 'copia_iban', {
        'event_category': 'engagement',
        'event_label': 'Regalo'
      });
    }
	
 		const btn = event.target;
 		const original = btn.textContent;
 		btn.textContent = '‚úì Copiato!';
 		btn.style.background = 'linear-gradient(135deg, #34a853 0%, #0f9d58 100%)';
 		setTimeout(function() {
 			btn.textContent = original;
 			btn.style.background = 'linear-gradient(135deg, #c9a961 0%, #b8945a 100%)';
 		}, 2000);
 	}).catch(function() {
 		alert('IBAN: ' + iban);
 	});
 }

 function showAudioPermission() {
 	 if (!envelopeOpened) return;
 		document.getElementById('audioPermission').classList.add('show');
 	
 }

 function startMusic() {
 	audio = document.getElementById('backgroundMusic');
 	audio.volume = 0.3;

 	audio.play().then(() => {
 		isPlaying = true;
 		document.getElementById('audioControl').style.display = 'block';
 		document.getElementById('audioPermission').classList.remove('show');
 		document.getElementById('audioToggleBtn').textContent = 'üîä';
 		document.getElementById('audioToggleBtn').classList.remove('muted');
 	}).catch(err => {
 		console.log('Autoplay bloccato:', err);
 	});
 }

 function declineMusic() {
 	document.getElementById('audioPermission').classList.remove('show');
 	document.getElementById('audioControl').style.display = 'block';
 	document.getElementById('audioToggleBtn').textContent = 'üîá';
 	document.getElementById('audioToggleBtn').classList.add('muted');
 }

 function toggleMusic() {
 	if (!audio) {
 		audio = document.getElementById('backgroundMusic');
 		audio.volume = 0.3;
 	}

 	const btn = document.getElementById('audioToggleBtn');

 	if (isPlaying) {
 		audio.pause();
 		btn.textContent = 'üîá';
 		btn.classList.add('muted');
 		isPlaying = false;
 	} else {
 		audio.play().then(() => {
 			btn.textContent = 'üîä';
 			btn.classList.remove('muted');
 			isPlaying = true;
 		}).catch(err => {
 			console.log('Errore riproduzione:', err);
 		});
 	}
 }

 //const audio = document.getElementById('background-music');
let wasPlaying = false;
 // Ferma quando si chiude/lascia la pagina
 window.addEventListener('beforeunload', () => {
 	if (audio) audio.pause();
 });

 // Ferma quando si cambia tab
document.addEventListener('visibilitychange', () => {
    if (audio) {
        if (document.hidden) {
            // Salva lo stato attuale prima di mettere in pausa
            wasPlaying = !audio.paused;
            audio.pause();
        } else {
            // Riprendi solo se era in riproduzione
            if (wasPlaying) {
                audio.play();
            }
        }
    }
});

 
 function reloadChatbot() {
    const messagesDiv = document.getElementById('chatbotMessages');
    
    // Animazione di fade out
    messagesDiv.style.opacity = '0';
    messagesDiv.style.transition = 'opacity 0.3s ease';
    
    setTimeout(() => {
        // Svuota i messaggi
        messagesDiv.innerHTML = '';
        
        // Reinizializza con il messaggio di benvenuto
        const lang = document.body.classList.contains('lang-english') ? 'en' : 'it';
        const welcomeMessage = lang === 'en' 
            ? 'üëã Hello! I\'m the wedding assistant. Ask me anything about Ornella and Francesco\'s big day!'
            : 'üëã Ciao! Sono l\'assistente del matrimonio. Chiedimi tutto su questo grande giorno di Ornella e Francesco!';
        
        addBotMessage(welcomeMessage, true);
        
        // Aggiorna il placeholder dell'input
        const inputIt = document.getElementById('chatbotInputIt');
        const inputEn = document.getElementById('chatbotInputEn');
        
        if (lang === 'en') {
            inputIt.style.display = 'none';
            inputEn.style.display = 'block';
        } else {
            inputIt.style.display = 'block';
            inputEn.style.display = 'none';
        }
        
        // Animazione di fade in
        messagesDiv.style.opacity = '1';
    }, 300);
}
 
 
 
 createSparkles();
 updateCountdown();
 setInterval(updateCountdown, 1000);
 window.addEventListener('scroll', animateOnScroll);
 window.addEventListener('resize', createSparkles);
 animateOnScroll();
 loadSavedLanguage();
 populatePresenzaSelect();
 

 // Enter key to send
 document.addEventListener('DOMContentLoaded', function() {
 	// Initialize chatbot
 	initChatbot();

 	// Add enter key listener for Italian input
 	const inputIt = document.getElementById('chatbotInputIt');
 	if (inputIt) {
 		inputIt.addEventListener('keypress', function(e) {
 			if (e.key === 'Enter') {
 				sendChatMessage();
 			}
 		});
 	}

 	// Add enter key listener for English input
 	const inputEn = document.getElementById('chatbotInputEn');
 	if (inputEn) {
 		inputEn.addEventListener('keypress', function(e) {
 			if (e.key === 'Enter') {
 				sendChatMessage();
 			}
 		});
 	}
 });
    </script>
  </body>
</html>

